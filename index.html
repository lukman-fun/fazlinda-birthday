<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HAPPY BIRTHDAY FAZLINDA AZZAHRA</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/vegas/2.6.0/vegas.min.css"
      integrity="sha512-1Z0z85WROTKiK0kBRjS8FbgLdYkGGzyPM66y7V/CIAB6ZTA5iKUei/3UoZAxtVFy2Nj8ddDt+cvduzeqfJZx9w=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />

    <style>
      body {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .app {
        width: 480px;
        position: relative;
        overflow: hidden;
      }

      .image-flashback {
        /* background-color: aqua; */
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        /* width: 100%;
        height: 100%; */
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        transition: background-image 2s ease-in-out;
        z-index: 1;
      }

      .image-blur {
        /* background-color: aqua; */
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(
          255,
          255,
          255,
          0.1
        ); /* Sedikit transparan untuk melihat blur */
        backdrop-filter: blur(
          4px
        ); /* Efek blur yang diterapkan ke apa pun di belakangnya */
        -webkit-backdrop-filter: blur(
          4px
        ); /* Untuk kompatibilitas browser berbasis WebKit */
        z-index: 2;
      }

      .main-content {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        z-index: 3;
      }

      #flipbook {
        height: 100%;
        width: 100%;
        transition: margin-left 0.25s ease-out;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      #flipbook .page {
        height: 100%;
        width: 100%;
        background-color: wheat;
      }

      #flipbook .page img {
        max-width: 100%;
        height: 100%;
      }

      @media (max-width: 768px) {
        .app {
          width: 100%;
        }
      }
    </style>
  </head>

  <body>
    <div class="app vh-100">
      <div class="image-flashback"></div>
      <div class="image-blur"></div>

      <div class="main-content h-100">
        <div class="container h-100">
          <div class="row justify-content-center h-100">
            <div class="col-12" id="greeting">
              <div
                class="d-flex align-items-center justify-content-between mt-4"
              >
                <img
                  src="https://res.cloudinary.com/dlknsxwvi/image/upload/v1757184267/birthday_fazlinda/birth_asset/ballon_swibry.webp"
                  alt=""
                  class="d-block animate__animated animate__pulse animate__slow animate__infinite"
                  style="width: 10rem"
                />
                <img
                  src="https://res.cloudinary.com/dlknsxwvi/image/upload/v1757184267/birthday_fazlinda/birth_asset/ballon_swibry.webp"
                  alt=""
                  class="d-block animate__animated animate__pulse animate__slow animate__infinite"
                  style="width: 10rem"
                />
              </div>
              <div
                class="d-flex flex-column align-items-center mt-4"
                style="background-color: rgba(0, 0, 0, 0.3)"
              >
                <h1
                  style="
                    font-size: 4rem;
                    -webkit-text-stroke: 1px black;
                    text-stroke: 1px black;
                  "
                  class="fw-bold text-center text-white"
                >
                  HAPPY BIRTHDAY
                </h1>
                <h3
                  style="
                    font-size: 2rem;
                    -webkit-text-stroke: 1px black;
                    text-stroke: 1px black;
                  "
                  class="fw-bold text-center text-white"
                >
                  FAZLINDA AZZAHRA
                </h3>
                <h3
                  style="
                    font-size: 2rem;
                    -webkit-text-stroke: 1px black;
                    text-stroke: 1px black;
                  "
                  class="fw-bold text-center text-white"
                >
                  07 September 2025
                </h3>
              </div>
              <div
                class="d-flex justify-content-center"
                style="margin-top: -2rem"
              >
                <img
                  src="https://res.cloudinary.com/dlknsxwvi/image/upload/v1757184268/birthday_fazlinda/birth_asset/cake_mv8sxe.webp"
                  alt=""
                  class="d-block animate__animated animate__pulse animate__slow animate__infinite"
                  style="width: 20rem"
                />
              </div>
            </div>
            <div
              class="col-12 d-flex align-items-center justify-content-center d-none"
              id="book"
            >
              <div id="flipbook">
                <div class="page">
                  <div
                    class="container d-flex flex-column justify-content-center align-items-center h-100"
                  >
                    <h1 class="fw-bold" style="font-size: 3rem">SEKLUMIT</h1>
                    <h1
                      class="fw-bold"
                      style="font-size: 6rem; margin-top: -2rem"
                    >
                      DO'A
                    </h1>
                    <h1
                      class="fw-bold"
                      style="font-size: 3rem; margin-top: -1.5rem"
                    >
                      UNTUKMU
                    </h1>
                    <div class="w-100 px-4">
                      <p
                        class="bg-dark text-white py-1 px-3 fw-bold text-center"
                      >
                        Sayangku, Fazlinda Azzahra
                      </p>
                    </div>
                    <div
                      class="fw-medium text-end w-100 pe-4"
                      style="font-size: 0.7rem; margin-top: -8px"
                    >
                      07 September 2025
                    </div>
                  </div>
                  <div
                    class="position-absolute text-white px-3 text-end"
                    style="
                      bottom: 0;
                      left: 0;
                      width: 100%;
                      background-color: rgba(0, 0, 0, 0.5);
                      font-size: 12px;
                    "
                  >
                    Slide dari kanan bawah/kanan atas ->
                  </div>
                </div>
                <div class="page">
                  <div class="container h-100" style="font-size: 1.5rem">
                    Selamat ulang tahun. Di hari yang spesial ini, aku mendoakan
                    yang terbaik untukmu. Semoga kamu selalu dipenuhi dengan
                    kebahagiaan, kesehatan, dan ketenangan hati. Aku berharap
                    kamu bisa terus tumbuh dan menjadi versi terbaik dari
                    dirimu, selalu menemukan kekuatan dan keindahan dalam setiap
                    perjalanan hidup.
                  </div>
                </div>
                <div class="page">
                  <div class="container h-100" style="font-size: 1.5rem">
                    Semoga setiap langkah yang kamu ambil membawa kebaikan dan
                    kesuksesan yang tulus. Semoga semua impian dan cita-cita
                    yang kamu simpan dalam hati bisa terwujud, satu per satu.
                    Aku berdoa agar kamu selalu dikelilingi oleh orang-orang
                    yang tulus dan hal-hal yang positif.
                  </div>
                </div>
                <div class="page">
                  <div class="container h-100" style="font-size: 1.5rem">
                    Aku akan selalu ada di sini, mendoakan dan mendukungmu dari
                    jauh atau dari dekat. Kamu adalah seseorang yang sangat
                    berarti. Semoga semua harapan baik yang ada di hatimu bisa
                    terwujud. Selamat ulang tahun, cintaku.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div
        id="overlay-loading"
        class="position-absolute bg-white"
        style="top: 0; left: 0; width: 100%; height: 100%; z-index: 9"
      >
        <div
          class="container w-100 h-100 d-flex flex-column justify-content-center align-items-center"
        >
          <p class="text-center">
            Setelah memuat asset, klik tombol dibawah, setelah itu tunggu 7
            detik untuk memunculkan surat do'a
          </p>
          <p id="loading-text">Memuat Asset...</p>
          <button id="btn-start" class="btn btn-primary px-4 d-none">
            Mulai
          </button>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script src="https://res.cloudinary.com/dlknsxwvi/raw/upload/v1757187171/birthday_fazlinda/birth_asset/turn_ja0vir.js"></script>
    <!-- <script src="https://www.turnjs.com/lib/turn.min.js"></script> -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/vegas/2.6.0/vegas.min.js"
      integrity="sha512-uOfjbJAFkZh3u1rr5UVKy3/SqJ+JSLzv28/8lgMSdeofAoHaOLA5Hdr/oZ/IEPaOthxjHDa/z9Ng4Th3ClNT5A=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <script type="text/javascript">
      $(document).ready(function () {
        const images = [
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757182990/birthday_fazlinda/IMG-20231116-WA0104_yahdik.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183045/birthday_fazlinda/IMG-20231116-WA0113_zviyfu.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183082/birthday_fazlinda/IMG-20231116-WA0183_kvoswu.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183096/birthday_fazlinda/IMG-20231116-WA0190_sfhmba.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183092/birthday_fazlinda/IMG-20231116-WA0191_qcbqhj.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183062/birthday_fazlinda/IMG-20240216-WA0067_pynce5.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757182926/birthday_fazlinda/IMG_20231212_170130_382_fpfofv.webp",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183025/birthday_fazlinda/IMG_20231222_140757_lnutas.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757182927/birthday_fazlinda/IMG_20240310_012844_332_un4x16.webp",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183160/birthday_fazlinda/IMG_4644_we3ohx.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183219/birthday_fazlinda/IMG_4646_brbb0w.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183212/birthday_fazlinda/IMG_4650_kghp4h.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183195/birthday_fazlinda/IMG_4656_lqxycu.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183215/birthday_fazlinda/IMG_4688_bgz5c0.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183242/birthday_fazlinda/IMG_4700_v4luvs.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183246/birthday_fazlinda/IMG_4704_nlfh4h.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183221/birthday_fazlinda/IMG_4711_bdldqg.jpg",
          "https://res.cloudinary.com/dlknsxwvi/image/upload/v1757183237/birthday_fazlinda/IMG_4713_opn2g3.jpg",
        ];

        const musicUrl =
          "https://res.cloudinary.com/dlknsxwvi/video/upload/v1757185581/birthday_fazlinda/birth_asset/Jamrud_-_Selamat_Ulang_Tahun_lyrics_ejgnuz.mp3";

        // Preload
        const assetsToLoad = images;
        // const assetsToLoad = [...images, musicUrl];
        let loadedCount = 0;
        const totalAssets = assetsToLoad.length;

        const audio = new Audio(musicUrl);

        function preloadAssets() {
          $.each(assetsToLoad, function (index, assetUrl) {
            let asset;
            if (assetUrl.endsWith(".mp3") || assetUrl.endsWith(".ogg")) {
              asset = new Audio();
            } else {
              asset = new Image();
            }

            $(asset).on("load error", function () {
              loadedCount++;
              const percentage = Math.floor((loadedCount / totalAssets) * 100);
              $("#loading-text").text(`Memuat Asset... ${percentage}%`);

              if (loadedCount === totalAssets) {
                $("#loading-text").fadeOut(function () {
                  $("#btn-start").removeClass("d-none").fadeIn();
                });
              }
            });
            asset.src = assetUrl;
          });
        }

        preloadAssets();
        // End Preload

        const slides = images.map((url) => ({ src: url }));

        $(".image-flashback").vegas({
          delay: 700,
          timer: false,
          shuffle: true,
          // transition: "fade",
          // transitionDuration: 2000,
          slides: slides,
        });

        const aspectRatio = 2 / 3;
        function getResponsiveMargin() {
          if (window.innerWidth > 768) {
            return window.innerWidth * 0.06;
          } else {
            return window.innerWidth * 0.08;
          }
        }

        function setFlipbookSize() {
          const container = $("#flipbook").parent();
          const availableWidth = container.width();
          const availableHeight = container.height();

          let newWidth, newHeight;
          const currentRatio = availableWidth / availableHeight;
          const margin = getResponsiveMargin();

          const effectiveWidth = availableWidth - margin * 2;
          const effectiveHeight = availableHeight - margin * 2;

          if (currentRatio > aspectRatio) {
            newHeight = effectiveHeight;
            newWidth = newHeight * aspectRatio;
          } else {
            newWidth = effectiveWidth;
            newHeight = newWidth / aspectRatio;
          }

          newWidth *= 1.1;
          newHeight *= 1.1;

          $("#flipbook").turn("size", newWidth, newHeight);
          $("#flipbook").turn("center");
        }

        $("#flipbook").turn({
          // width: 400,
          // height: 300,
          // display: 'single',
          display: "single",
          acceleration: true,
          gradients: !$.isTouch,
          elevation: 300,
          autoCenter: true,
          when: {
            turned: function (e, page) {
              /*console.log('Current view: ', $(this).turn('view'));*/
            },
          },
        });

        setFlipbookSize();

        $(window).resize(function () {
          setFlipbookSize();
        });

        $("#btn-start").click(function () {
          audio.play().catch((e) => console.error("Error playing audio:", e));
          $("#overlay-loading").remove();

          setTimeout(function () {
            $("#greeting").fadeOut(function () {
              $("#book").removeClass("d-none").fadeIn();
              setFlipbookSize();
            });
          }, 7000);
        });
      });
    </script>
  </body>
</html>
